<div *ngIf="project">
  <section class="content-header">
    <h1>Proyectos <small>{{project.name}}</small></h1>
    <ol class="breadcrumb">
      <li><a><i class="fa fa-briefcase"></i> Proyectos</a></li>
      <li class="active">{{project.name}}</li>
    </ol>
  </section>
  <section class="content">
    <div class="row">
      <div class="col-xs-12">
        <div class="box box-primary">
          <div class="box-header with-border">
            <button type="button" class="btn btn-link btn-xs" (click)="back()">
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
          </button>
            <h3 class="box-title">Editar Proyecto</h3>
          </div>
          <form role="form" (submit)="edit()">
            <div class="box-body">
              <div class="form-group">
                <label for="name">Nombre:</label>
                <input type="text" id="name" name="name" class="form-control" [(ngModel)]="project.name">
              </div>
              <div class="form-group">
                <label for="dateRange">Duración:</label>
                <div class="input-group" id="dateRange" daterangepicker (selected)="selectedDate($event)">
                  <span class="form-control uneditable-input" name="daterange">
                    {{ project.startDate | date:'dd/MM/yyyy' }} - {{ project.endDate| date:'dd/MM/yyyy' }}
                </span>
                  <span class="input-group-btn">
                    <a type="button" class="btn btn-default"><i class="glyphicon glyphicon-calendar"></i></a>
                </span>
                </div>
              </div>
              <div class="form-group">
                <button type="button" class="btn btn-success" data-toggle="modal" data-target="#modal-activiy">Crear Actividad</button>
              </div>
              <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" *ngIf="project.activity.length > 0">
                <div class="panel panel-default" *ngFor="let a of project.activity; let i = index" [attr.data-index]="i">
                  <div class="panel-heading" role="tab" [id]="'heading'+i">
                    <h4 class="panel-title">
                      <a role="button" data-toggle="collapse" data-parent="#accordion" [href]="'#collapse'+i" aria-expanded="false" aria-controls="collapseOne">
                        <i class="fa fa-folder-open-o" aria-hidden="true"></i> {{a.name}}
                      </a>
                    </h4>
                  </div>
                  <div [id]="'collapse'+i" class="panel-collapse collapse" role="tabpanel">
                    <div class="panel-body">
                      <div class="table-responsive" *ngIf="a.task.length > 0">
                        <table class="table table-bordered">
                          <thead>
                            <tr>
                              <th>Nombre</th>
                              <th>Inicio</th>
                              <th>Fin</th>
                              <th>Acciones</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let t of a.task">
                              <td>
                                {{t.name}}
                              </td>
                              <td>{{t.start | date:'dd/MM/yyyy'}}</td>
                              <td>{{t.end | date:'dd/MM/yyyy'}}</td>
                              <td>
                                <button type="button" class="btn btn-default"><i class="fa fa-eye fa-lg"></i></button>
                                <button type="button" class="btn btn-danger" (click)="deleteTask(a,t)"><i class="fa fa-trash-o fa-lg"></i></button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="form-group">
                        <button type="button" class="btn btn-default" data-toggle="modal" data-target="#modal-task" (click)="upActivity(a)"><i class="fa fa-plus fa-lg"></i></button>
                        <button type="button" class="btn btn-danger" (click)="deleteActivity(a)"><i class="fa fa-trash-o fa-lg"></i></button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="box-footer">
              <button type="submit" class="btn btn-default"><i class="fa fa-floppy-o fa-lg"></i> Guardar cambios</button>
              <button class="btn btn-danger" (click)="delete()"><i class="fa fa-trash-o fa-lg"></i> Eliminar</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12">
        <div class="box box-primary">
          <div id="chartdiv" [style.width.%]="100" [style.height.px]="500"></div>
        </div>
      </div>
    </div>
  </section>
</div>
<div class="modal fade" id="modal-activiy">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Actividad</h4>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="activity_name">Nombre:</label>
          <input type="text" id="activity_name" name="activity_name" class="form-control" [(ngModel)]="activity.name">
        </div>
        <div class="form-group">
          <label for="dateRange">Duración:</label>
          <div class="input-group" id="activity_dateRange" daterangepicker (selected)="selectedActivityDate($event)">
            <span class="form-control uneditable-input" name="activity_daterange">
                    {{ activity.start | date:'dd/MM/yyyy' }} - {{ activity.end | date:'dd/MM/yyyy' }}
                </span>
            <span class="input-group-btn">
                    <a type="button" class="btn btn-default"><i class="glyphicon glyphicon-calendar"></i></a>
                </span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-success" data-dismiss="modal" (click)="addActivity(activity)">Guardar Cambios</button>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
<div class="modal fade" id="modal-task">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Tarea</h4>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="task_name">Nombre:</label>
          <input type="text" id="task_name" name="task_name" class="form-control" [(ngModel)]="task.name">
        </div>
        <div class="form-group">
          <label for="dateRange">Duración:</label>
          <div class="input-group" id="task_dateRange" daterangepicker (selected)="selectedTaskDate($event)">
            <span class="form-control uneditable-input" name="task_daterange">
                    {{ task.start | date:'dd/MM/yyyy' }} - {{ task.end | date:'dd/MM/yyyy' }}
                </span>
            <span class="input-group-btn">
                    <a type="button" class="btn btn-default"><i class="glyphicon glyphicon-calendar"></i></a>
                </span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-success" data-dismiss="modal" (click)="addTask(activity)">Guardar Cambios</button>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
